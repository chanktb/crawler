<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<title>CrawlerV5 - Cloudflare Proxy</title>
<style>
  body { font-family: Arial, sans-serif; background:#f4f6fa; margin:0; padding:20px; text-align:center; }
  h1 { font-size:22px; margin-bottom:20px; }
  .domains { margin-bottom:20px; display:flex; flex-direction:column; gap:10px; align-items:center; }
  .domain { background:#fff; padding:10px 15px; border-radius:8px; border:1px solid #ddd; width:320px; display:flex; justify-content:space-between; align-items:center; }
  button { padding:6px 12px; cursor:pointer; border:none; border-radius:5px; background:#2563eb; color:white; }
  button:hover { background:#1d4ed8; }
  #status { margin:15px 0; color:#555; font-style:italic; }
  .results { display:flex; flex-direction:column; gap:16px; align-items:center; }
  .product { background:#fff; border:1px solid #ddd; padding:12px; border-radius:10px; width:720px; text-align:center; }
  .product img { max-width:700px; height:auto; border-radius:8px; margin-bottom:8px; }
  .title { font-weight:bold; font-size:16px; }
</style>
</head>
<body>
<h1><a href="/crawler/">DANH S√ÅCH TOOL</a></h1>
<h1>üß≠ CrawlerV5 (Cloudflare Proxy)</h1>

<div class="domains">
  <div class="domain">
    <b>teespix.com</b>
    <button onclick="showProducts('teespix')">Show s·∫£n ph·∫©m</button>
  </div>
  <div class="domain">
    <b>techteesusa.com</b>
    <button onclick="showProducts('techteesusa')">Show s·∫£n ph·∫©m</button>
  </div>
  <div class="domain">
    <b>geekteesus.com</b>
    <button onclick="showProducts('geekteesus')">Show s·∫£n ph·∫©m</button>
  </div>
</div>

<div id="status">Ch∆∞a qu√©t.</div>
<div id="results" class="results"></div>

<script>
// üëâ s·ª≠a l·∫°i th√†nh domain Worker c·ªßa b·∫°n
const proxy = "https://cors-proxy.trantpu.workers.dev/?url=";

// --- Config ---
const domains = {
  teespix: {
    url: "https://teespix.com/",
    containerSel: ".row.large-columns-4.medium-columns-3.small-columns-2.row-small.slider.row-slider.slider-nav-reveal.slider-nav-push",
    itemSel: "div.product",
    titleSel: "a[aria-label]",
    titleAttr: "aria-label",
    imgSel: "img",
    imgAttr: "src"
  },
  techteesusa: {
    url: "https://techteesusa.com/",
    containerSel: "div.row.large-columns-5.medium-columns-3.small-columns-2.row-normal",
    itemSel: ".product-small.box",
    titleSel: "p.name.product-title a",
    imgSel: "img",
    imgAttr: "src"
  },
  teeworksusa: {
    url: "https://teeworksusa.com/",
    containerSel: "div.posts-wrap.products-container.has-ccols.ccols-xl-4.ccols-md-3.ccols-sm-2.ccols-2.has-ccols-spacing",
    itemSel: "div.porto-tb-item.product",
    titleSel: "h3.porto-heading a",
    imgSel: "img",
    imgAttr: "src"
  },
  geekteesus: {
    url: "https://geekteesus.com/",
    containerSel: [
      "div.row.large-columns-4.medium-columns-3.small-columns-2.row-xsmall.row-full-width",
      "div.row.large-columns-4.medium-columns-3.small-columns-2.row-xsmall"
    ],
    itemSel: ".product-small.box",
    titleSel: "p.name.product-title a",
    imgSel: "img",
    imgAttr: "src"
  }
};

// --- Tool ---
async function showProducts(domainKey) {
  const cfg = domains[domainKey];
  document.getElementById("status").innerText = `ƒêang qu√©t ${cfg.url}...`;
  document.getElementById("results").innerHTML = "";

  try {
    const res = await fetch(proxy + encodeURIComponent(cfg.url));
    if (!res.ok) throw new Error("Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu.");
    const text = await res.text();
    const doc = new DOMParser().parseFromString(text, "text/html");

    let items = [];
    if (Array.isArray(cfg.containerSel)) {
      cfg.containerSel.forEach(sel => {
        const container = doc.querySelector(sel);
        if (container) {
          const found = container.querySelectorAll(cfg.itemSel);
          found.forEach(it => items.push(it));
        }
      });
    } else {
      const container = doc.querySelector(cfg.containerSel);
      if (container) items = container.querySelectorAll(cfg.itemSel);
    }

    const results = [];
    items.forEach(it => {
      let title = "";
      if (cfg.titleAttr) {
        const tEl = it.querySelector(cfg.titleSel);
        if (tEl) title = tEl.getAttribute(cfg.titleAttr) || "";
      } else {
        const tEl = it.querySelector(cfg.titleSel);
        if (tEl) title = tEl.textContent.trim();
      }

      let img = "";
      let imgEls = it.querySelectorAll(cfg.imgSel);
      if (imgEls.length > 1 && domainKey === 'teeworksusa') {
        img = imgEls[1].getAttribute(cfg.imgAttr) || "";
      } else if (imgEls.length > 0) {
        img = imgEls[0].getAttribute(cfg.imgAttr) || "";
      }

      results.push({title, img});
    });
    render(results);
    document.getElementById("status").innerText = `T√¨m th·∫•y ${results.length} s·∫£n ph·∫©m`;
  } catch(e) {
    console.error(e);
    document.getElementById("status").innerText = "L·ªói: " + e.message;
  }
}

function render(list) {
  const box = document.getElementById("results");
  box.innerHTML = "";
  list.forEach((p,i)=>{
    const div = document.createElement("div");
    div.className = "product";
    div.innerHTML = `
      <div><b>#${i+1}</b></div>
      ${p.img ? `<img src="${p.img}" />` : "(no image)"}
      <div class="title">${p.title||"(no title)"}</div>
    `;
    box.appendChild(div);
  });
}
</script>
</body>
</html>





