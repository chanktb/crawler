<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Extractor TechTeesUSA</title>
<style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
    h2 { color: #333; }
    input[type="file"] { margin: 10px 0; }
    .product { margin-bottom: 30px; padding: 10px; background: white; border-radius: 5px; }
    .product img { max-width: 700px; height: auto; display: block; margin-bottom: 10px; }
    .title { font-weight: bold; font-size: 18px; }
</style>
</head>
<body>
<h1><a href="/crawler/">Danh sách tools</a></h1>
<h2>Extractor sản phẩm TechTeesUSA</h2>
<p>Truy cập TechTeesUSA sau đó chuột phải Save as, chọn Webpage html only, sau đó upload file bên dưới.</p>
<input type="file" id="fileInput" accept=".html,.htm">

<div id="output"></div>

<script>
document.getElementById('fileInput').addEventListener('change', function(event) {
    const file = event.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function(e) {
        const parser = new DOMParser();
        const doc = parser.parseFromString(e.target.result, 'text/html');

        const startDiv = doc.querySelector('div.row.large-columns-5.medium-columns-3.small-columns-2.row-normal');
        if (!startDiv) {
            alert('Không tìm thấy danh sách sản phẩm.');
            return;
        }

        const products = startDiv.querySelectorAll('.product-small.box');
        let outputHTML = '';
        let index = 1;

        products.forEach(prod => {
            const imgTag = prod.querySelector('img');
            const titleTag = prod.querySelector('p.name.product-title a');

            let imgSrc = imgTag ? imgTag.getAttribute('src') : '';

            // Nếu link ảnh không bắt đầu bằng http => chuyển sang domain gốc
            if (imgSrc && !imgSrc.startsWith('http')) {
                const fileName = imgSrc.split('/').pop(); // lấy tên file ảnh
                imgSrc = 'https://images.techteesusa.com/2025/08/' + fileName;
            }

            const title = titleTag ? titleTag.textContent.trim() : 'Không có tiêu đề';

            outputHTML += `
                <div class="product">
                    <div>#${index}</div>
                    ${imgSrc ? `<img src="${imgSrc}" alt="Product Image">` : ''}
                    <div class="title">${title}</div>
                </div>
            `;
            index++;
        });

        document.getElementById('output').innerHTML = outputHTML;
    };
    reader.readAsText(file);
});
</script>

</body>
</html>
